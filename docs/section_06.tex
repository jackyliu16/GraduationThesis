\section{结论}
    指纹考勤系统以树莓派4B（BCM2711）为核心，包括以下组件：
    指纹传感器HLK-FPM383C、
    基于树莓派板载BCM54213PE PHY芯片的通信模块，
    以及由上位机提供的数据存储，日志记录的部分。\\

    \noindent 全文主要完成了以下六个方面的工作：

    \begin{itemize}
        \item 完成了指纹考勤系统整体设计，对于一个最简易的单片机指纹考勤系统进行了需求分析。
        \item 完成了指纹考勤系统硬件电路设计。主要包括主控模块与信号回返模块，串口输入模块之间的硬件电路设计。
        \item 在组件化操作系统 ArceOS 上仿照树莓派官方 linux 内核中驱动相关实现，实现并整合了一个能运行的以太网驱动，
            该驱动实现了以太网物理层与数据链路层之间的通信，
            嵌入式裸机应用程序可以深度集成到ArceOS中，调用由 ArceOS 实现的 Tcp/Udp 以太网协议栈以在应用层面调用 UdpSocket 所提供的服务编译成一个完整的单一用途裸机应用程序。
            通过这个以太网驱动，可以实现下位机与上位机之间的以太网帧通信\ref{fig::树莓派通信正常}。
        \item 将上述以太网驱动与 ArceOS 中提供上层网络包装的 axnet module\footnote{基于smlotcp的实现} 进行结合，
            实现了基于 UdpSocket 的发包功能。
        \item 在组件化操作系统 ArceOS 中，基于自建 UART 串口驱动与FPM383模组通信协议\cite{fpm383c-modular-communication-protocol}，
            实现了 ArceOS 的指纹模块，能基于串口信号传输，实现简单的如LED亮灯，要求FPM383C模块进行指纹匹配，
            对于收到的指纹匹配结果进行分析等功能。
        \item 根据上述指纹考勤系统设计需求，实现了一个基于 ArceOS 改写标准库的裸机应用程序。
    \end{itemize}


本论文提供的成果作为 ArceOS 组件化操作系统驱动程序计划提交到主仓库中，预计在该操作系统树莓派支持上占据一定地位。

本论文以一个简单的嵌入式入门项目，考勤系统为例，在尚未实现对应驱动的 ArceOS 上实现其所依赖的必要驱动如 
FPM383C 指纹识别模块驱动，BCM54213PE 网卡通信驱动等，论证了组件化操作系统在一般嵌入式开发场景中的作用。

在本次论文的开发中，我完成了基于 ArceOS 的开发环境搭建如交叉编译链构建，Rust语言工具链配置，基于nix的开发环境搭建等。
重点分析了如 u-boot， circle， 树莓派 linux 操作系统在 树莓派 4B 上的 BCM54213PE PHY 网络驱动，
了解了驱动实现过程中牵涉到的 MDIO 通信协议，DMA(直接记忆存取）机制。
基于前人的工作将其深度嵌合到 ArceOS 操作系统中，利用现有 ArceOS 操作系统提供的上层以太网协议栈支持，
并最终完成了 ArceOS 操作系统的 udpsocket 支持\footnote{目前仅完成了这个部分的测试}。
同时，基于 FPM383C 指纹识别模块通信协议，在树莓派现有基于寄存器实现的 UART 支持下，通过对于寄存器进行操作
实现了基于串口的指纹识别模块通信解析与发送。

最终，在应用层面实现了一个能完成基本指纹考勤打卡功能的嵌入式系统。其中包括各个打卡终端，定时进行指纹采集，
将采集结果通过网络发送给上位机，上位机收到对应数据信息之后将打卡记录记录到数据库中以便查阅\footnote{计划还完成
上位机在收到对应信息之后的反馈，但目前由于收包部分还有部分合并工作没有完成，尚处于停滞状态}。
同时，还实现了指纹注册并下发机制，该机制由上位机实现，在上位机从属指纹识别模块录入指纹之后，上位机会基于一个 python 实现的
串口通信机制，获取对应从属模块的数据并通过网络下发到所有客户端。
\footnote{计划中完成定期指纹模板检测，自动发送对应特征长度给上位机进行检测，覆盖不匹配的数据}

虽然本文的工作取得了初步的成功，完成了树莓派 4B 上的基础网络支持，但要使 ArceOS 组件化操作系统的功能更加强大，更加完善，还需要很多工作要做。
同时，本文仅仅在一个相对比较完善的嵌入式平台（树莓派）上完成了驱动的改写，
虽然利用到了组件化操作系统所提供的条件编译带来的操作系统镜像大小优势，但是并没有尝试利用这一优点
\footnote{目前利用到这个优势的地方仅有通过串口传输二进制镜像文件，
ArceOS 编译出的镜像文件有且仅有不到200kb，相较于一般嵌入式操作系统大小小很多}实现什么特别的操作，
也没有通过降级 MCU 体现 ArceOS 操作系统可能的成本优势，同时 BCM54213PE PHY 网络芯片是一个专有的网络芯片，
基本上在树莓派以外的设备中很少见到有嵌入式设备使用了这款芯片，选择的驱动普世性不强。
只是我的实现，论证了确实 ArceOS 系统是可以
用于嵌入式开发的，在开发难度上相对 Exokernl 等较低，但驱动重写实际上工作量不低，可能对于现有设备
厂商而言，开发成本不太经济。
